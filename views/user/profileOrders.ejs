<%- include ('../layouts/header.ejs') %>

  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <style>
        .table {
            border-collapse: separate;
            border-spacing: 0;
            width: 80%;
            max-width: 100%;
            margin-bottom: 1rem;
            background-color: transparent;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .table th,
        .table td {
            padding: 1rem;
            vertical-align: middle;
            text-align: center;
        }

        .table thead th {
            background-color: #343a40;
            color: white;
            text-transform: uppercase;
            font-weight: bold;
            border: none;
            padding: 1.5rem;
        }

        .table tbody tr {
            transition: all 0.3s ease-in-out;
        }

        .table tbody tr:hover {
            background-color: #f8f9fa;
        }

        .table td {
            font-size: 1.3rem;
            border-top: 1px solid #dee2e6;
        }

        .badge-primary {
            background-color: #ffffff;
            color: rgb(31, 45, 33);
            font-size: 1.2rem;
            padding: 0.4em 0.6em;
            border-radius: 12px;
        }

        .text-success {
            font-weight: bold;
        }

        .table td .btn-primary {
            background-color: #ffffff;
            border-color: #ffffff;
            color: rgb(0, 0, 0);
            font-weight: bold;
            padding: 0.25rem 0.5rem;
            transition: background-color 0.3s ease;
        }

        .table td .btn-primary:hover {
            background-color: #ffffff;
            border-color: #004085;
        }

        .table td .fas {
            font-size: 1.3rem;
        }



        .modal-body .card {
            margin-bottom: 1rem;
        }

        .modal-body .table-invoice {
            margin-bottom: 0;
        }

        .modal-body .total-row {
            font-weight: bold;
        }

        .modal-content {
            width: 775px;
        }
    </style>

    <div class="page-wrapper">
        <header class="header">

            <div class="header-top">
                <div class="container">
                    <div class="header-left col-lg-7">
                        <nav aria-label="breadcrumb" class="breadcrumb-nav border-0 mb-0">
                            <div class="container breadcrumbs">
                                <ol class="breadcrumb">
                                  
                                    <!-- Current page breadcrumb without link -->
                                    <li class="breadcrumb-item active" aria-current="page">
                                        My Account
                                    </li>
                                </ol>
                            </div>
                            <!-- End .container -->
                        </nav>
                        <!-- End .breadcrumb-nav -->
                    </div>
                    <div class="header-right col-lg-5">
                        <ul class="top-menu">
                            <li>
                                <a href="#">Links</a>
                                <ul>
                                    <li>
                                        <a href="/wishlist"><i class="icon-heart-o"></i>Wishlist
                                            <span>
                                                (4)
                                            </span>
                                        </a>
                                    </li>
                                    <li><a href="about.html">About Us</a></li>
                                    <li><a href="/contact-us">Contact Us</a></li>
                                    <% if (user) { %>
                                        <li>
                                            <a href="userprofile"><i class="icon-user"></i>
                                                <%= user.name || user.displayName %>
                                            </a>
                                        </li>
                                        <% } else { %>
                                            <li>
                                                <a href="/login"><i class="icon-user"></i>Login</a>
                                            </li>
                                           <% } %>
                                </ul>
                            </li>
                        </ul>
                        <!-- End .top-menu -->
                    </div>
                    <!-- End .header-right -->
                </div>
                <!-- End .container -->
              
            </div>
            <div class="header-bottom sticky-header">
                <div class="container">
                    <div class="header-left">
                        <button class="mobile-menu-toggler">
                            <span class="sr-only">Toggle mobile menu</span>
                            <i class="icon-bars"></i>
                        </button>

                        <a href="index.html" class="logo">
                            <img src="/images/ww logo black.jpg" alt="Molla Logo" width="82" height="20">
                        </a>
                    </div>
                    <div class="header-center">
                        <nav class="main-nav">
                            <ul class="menu sf-arrows">
                                <li class="megamenu-container active">
                                    <a href="productlist" class="sf-with-ul">Home</a>


                                </li>
                                <li>
                                    <a href="category" class="sf-with-ul">Category</a>

                                    <div class="megamenu megamenu-md">
                                        <div class="row no-gutters">
                                            <div class="col-md-8">
                                                <div class="menu-col">
                                                    <div class="row">


                                                        <div class="col-md-6">
                                                            <div class="menu-title">Product Categories</div>
                                                            <!-- End .menu-title -->
                                                            <ul>
                                                                <li><a href="category">Product
                                                                        Category</a></li>

                                                            </ul>

                                                        </div><!-- End .row -->
                                                    </div><!-- End .menu-col -->
                                                </div><!-- End .col-md-8 -->
                                            </div><!-- End .row -->
                                        </div><!-- End .megamenu megamenu-md -->
                                </li>
                                <li>
                                    <a href="productlist" class="sf-with-ul">Product</a>

                                    
                                </li>
                                <li>
                                    <a href="#" class="sf-with-ul">Pages</a>

                                    <ul>
                                        <li>
                                            <a href="about.html">About</a>

                                        </li>
                                        <li>
                                            <a href="contact.html">Contact</a>

                                        </li>
                                        <li><a href="login.html">Login</a></li>
                                        <li><a href="userprofile">My Account</a></li>
                                        <li><a href="coming-soon.html">Coming Soon</a></li>
                                    </ul>
                                </li>

                                <li>
                                    <a href="elements-list.html" class="sf-with-ul">Elements</a>

                                    <ul>
                                        <li><a href="elements-products.html">Products</a></li>
                                        <li><a href="elements-typography.html">Typography</a></li>
                                        <li><a href="elements-titles.html">Titles</a></li>
                                        <li><a href="elements-banners.html">Banners</a></li>
                                        <li><a href="elements-product-category.html">Product Category</a></li>
                                        <li><a href="elements-video-banners.html">Video Banners</a></li>
                                        <li><a href="elements-buttons.html">Buttons</a></li>
                                        <li><a href="elements-accordions.html">Accordions</a></li>
                                        <li><a href="elements-tabs.html">Tabs</a></li>
                                        <li><a href="elements-testimonials.html">Testimonials</a></li>
                                        <li><a href="elements-blog-posts.html">Blog Posts</a></li>
                                        <li><a href="elements-portfolio.html">Portfolio</a></li>
                                        <li><a href="elements-cta.html">Call to Action</a></li>
                                        <li><a href="elements-icon-boxes.html">Icon Boxes</a></li>
                                    </ul>
                                </li>
                            </ul><!-- End .menu -->
                        </nav><!-- End .main-nav -->
                    </div><!-- End .header-left -->

                    <div class="header-right">
                        <div class="header-search">
                            <a href="#" class="search-toggle" role="button"><i class="icon-search"></i></a>
                            <form action="#" method="get">
                                <div class="header-search-wrapper">
                                    <label for="q" class="sr-only">Search</label>
                                    <input type="search" class="form-control" name="q" id="q" placeholder="Search in..."
                                        required>
                                </div><!-- End .header-search-wrapper -->
                            </form>
                        </div><!-- End .header-search -->

                        <a href="wishlist" class="wishlist-link">
                            <i class="icon-heart-o"></i>
                            <span class="wishlist-count">3</span>
                        </a>

                        <div class="dropdown cart-dropdown">
                            <a href="/cart" class="dropdown-toggle" role="button">
                                <i class="icon-shopping-cart"></i>
                                <span class="cart-count">2</span>
                            </a>
                        </div>
                    </div><!-- End .header-right -->
                </div><!-- End .container -->
            </div><!-- End .header-bottom -->
        </header><!-- End .header -->

        <main class="main">
            <div class="page-header text-center" style="background-image: url('assets/images/page-header-bg.jpg')">
                <div class="container">
                    <h1 class="page-title">My Account<span>Shop</span></h1>
                </div><!-- End .container -->
            </div><!-- End .page-header -->
            <nav aria-label="breadcrumb" class="breadcrumb-nav mb-3">
                <div class="container">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/home">Home</a></li>
                        <li class="breadcrumb-item active" aria-current="page">My Account</li>
                    </ol>
                </div><!-- End .container -->
            </nav><!-- End .breadcrumb-nav -->

            <div class="page-content">
                <div class="dashboard">
                    <div class="container">
                        <div class="row">
                            <aside class="col-md-4 col-lg-3">
                                <ul class="nav nav-dashboard flex-column mb-3 mb-md-0" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link " href="userprofile" role="tab">Account Details</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link active" href="profileOrders" role="tab">Orders</a>
                                    </li>

                                    <li class="nav-item">
                                        <a class="nav-link" href="/profileAddress" role="tab">Adresses</a>
                                    </li>


                                    <li class="nav-item">
                                        <a class="nav-link" href="#" id="logoutLink">Sign Out</a>
                                    </li>

                                </ul>
                            </aside>



                            <div class="col-md-8 col-lg-9">
                                <div class="tab-content">


                                    <div class="tab-pane fade show active" id="tab-dashboard" role="tabpanel" aria-labelledby="tab-dashboard-link">
                                        <% if (orders && orders.length > 0) { %>
                                            <div class="container">
                                                <div class="table-responsive">
                                                    <table class="table table-hover table-bordered">
                                                        <thead class="thead-dark">
                                                            <tr>
                                                                <th scope="col">Image</th>
                                                                <th scope="col">Order ID</th>
                                                                <th scope="col">Order Date</th>
                                                                <th scope="col">Status</th>
                                                                <th scope="col">Details</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            
                                                            <% orders.forEach(order => { %>
                                                                <tr>
                                                                    <td>
                                                                        <% if (order.productImages && order.productImages.length > 0) { %>
                                                                            <img src="/images/<%= order.productImages[0] %>" alt="Product Image" style="width: 50px; height: 50px; object-fit: cover; margin-left: 29px;">
                                                                        <% } else { %>
                                                                            <img src="/images/placeholder.jpg" alt="No Image Available" style="width: 50px; height: 50px; object-fit: cover;">
                                                                        <% } %>
                                                                    </td>
                                                                    <td><strong>#<%= order.orderId %></strong></td>
                                                                    <td><%= new Date(order.createdAt).toLocaleDateString() %></td>
                                                                    <td><span class="badge badge-primary"><%= order.status %></span></td>
                                                                    <td>
                                                                        <button type="button" class="btn btn-primary btn-sm view-order-btn" data-toggle="modal" data-target="#orderModal" data-order-id="<%= order._id %>">
                                                                            View <i class="fas fa-eye"></i>
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                            <% }); %>
                                                            
                                                            
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        <% } else { %>
                                            <div class="container">
                                                <div class="alert alert-info" role="alert">
                                                    <i class="fas fa-info-circle"></i> You have no orders yet.
                                                </div>
                                            </div>
                                        <% } %>
                                    </div>

                                </div>
                                <!-- pagination -->
                                <nav aria-label="Page navigation">
                                    <ul class="pagination justify-content-center">
                                        <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
                                            <a class="page-link page-link-prev" href="?page=<%= currentPage - 1 %>"
                                                aria-label="Previous" tabindex="-1">
                                                <span aria-hidden="true"><i class="icon-long-arrow-left"></i></span>Prev
                                            </a>
                                        </li>

                                        <% for (let i=1; i <=totalPages; i++) { %>
                                            <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                                <a class="page-link" href="?page=<%= i %>">
                                                    <%= i %>
                                                </a>
                                            </li>
                                            <% } %>

                                                <li
                                                    class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
                                                    <a class="page-link page-link-next"
                                                        href="?page=<%= currentPage + 1 %>" aria-label="Next">
                                                        Next <span aria-hidden="true"><i
                                                                class="icon-long-arrow-right"></i></span>
                                                    </a>
                                                </li>
                                    </ul>
                                </nav>
                            </div>


                        </div><!-- End .row -->
                    </div><!-- End .container -->
                </div><!-- End .dashboard -->
            </div><!-- End .page-content -->
        </main><!-- End .main -->
        

        <!-- Order Details Modal -->
        <!-- Order Details Modal -->
<div class="modal fade" id="orderModal" tabindex="-1" role="dialog" aria-labelledby="orderModalLabel"
aria-hidden="true">
<div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="orderModalLabel">Order Details</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <!-- Order details will be inserted here -->
        </div>
    </div>
</div>
</div>

       <!-- Cancellation Reason Modal -->
<div class="modal fade" id="cancelItemModal" tabindex="-1" role="dialog" aria-labelledby="cancelItemModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="cancelItemModalLabel"><i class="fas fa-times-circle"></i> Cancel Item</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="cancelItemForm">
                    <div class="form-group">
                        <label for="cancelReason" class="font-weight-bold">Reason for cancellation:</label>
                        <textarea class="form-control border-danger" id="cancelReason" rows="4" placeholder="Please provide a reason..." required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer justify-content-between">
                <button type="button" class="btn btn-outline-secondary" data-dismiss="modal"><i class="fas fa-arrow-left"></i> Close</button>
                <button type="button" class="btn btn-danger" id="confirmCancelItem"><i class="fas fa-paper-plane"></i> Request Cancellation</button>
            </div>
        </div>
    </div>
</div>

<!-- Return Reason Modal -->
<div class="modal fade" id="returnItemModal" tabindex="-1" role="dialog" aria-labelledby="returnItemModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header bg-warning text-white">
                <h5 class="modal-title" id="returnItemModalLabel"><i class="fas fa-undo-alt"></i> Return Item</h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="returnItemForm">
                    <div class="form-group">
                        <label for="returnReason" class="font-weight-bold">Reason for return:</label>
                        <textarea class="form-control border-warning" id="returnReason" rows="4" placeholder="Please provide a reason..." required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer justify-content-between">
                <button type="button" class="btn btn-outline-secondary" data-dismiss="modal"><i class="fas fa-arrow-left"></i> Close</button>
                <button type="button" class="btn btn-warning" id="confirmReturnItem"><i class="fas fa-paper-plane"></i> Request Return</button>
            </div>
        </div>
    </div>
</div>
<style>
    .form-group {
    margin-bottom: 2rem;
    width: 540px;
    margin-left: 15px;
}
.modal-content {
    width: 775px;
}

.modal-dialog {
    display: flex;
    align-items: center; 
    justify-content: center; 
    min-height: calc(100% - 1rem); 
}
</style>        

        <footer class="footer">
            <div class="footer-middle">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-6 col-lg-3">
                            <div class="widget widget-about">
                                <img src="assets/images/logo.png" class="footer-logo" alt="Footer Logo" width="105"
                                    height="25">
                                <p>Praesent dapibus, neque id cursus ucibus, tortor neque egestas augue, eu vulputate
                                    magna eros eu erat. </p>

                                <div class="social-icons">
                                    <a href="#" class="social-icon" target="_blank" title="Facebook"><i
                                            class="icon-facebook-f"></i></a>
                                    <a href="#" class="social-icon" target="_blank" title="Twitter"><i
                                            class="icon-twitter"></i></a>
                                    <a href="#" class="social-icon" target="_blank" title="Instagram"><i
                                            class="icon-instagram"></i></a>
                                    <a href="#" class="social-icon" target="_blank" title="Youtube"><i
                                            class="icon-youtube"></i></a>
                                    <a href="#" class="social-icon" target="_blank" title="Pinterest"><i
                                            class="icon-pinterest"></i></a>
                                </div><!-- End .soial-icons -->
                            </div><!-- End .widget about-widget -->
                        </div><!-- End .col-sm-6 col-lg-3 -->

                        <div class="col-sm-6 col-lg-3">
                            <div class="widget">
                                <h4 class="widget-title">Useful Links</h4><!-- End .widget-title -->

                                <ul class="widget-list">
                                    <li><a href="about.html">About Molla</a></li>
                                    <li><a href="#">How to shop on Molla</a></li>
                                    <li><a href="#">FAQ</a></li>
                                    <li><a href="contact.html">Contact us</a></li>
                                    <li><a href="login.html">Log in</a></li>
                                </ul><!-- End .widget-list -->
                            </div><!-- End .widget -->
                        </div><!-- End .col-sm-6 col-lg-3 -->

                        <div class="col-sm-6 col-lg-3">
                            <div class="widget">
                                <h4 class="widget-title">Customer Service</h4><!-- End .widget-title -->

                                <ul class="widget-list">
                                    <li><a href="#">Payment Methods</a></li>
                                    <li><a href="#">Money-back guarantee!</a></li>
                                    <li><a href="#">Returns</a></li>
                                    <li><a href="#">Shipping</a></li>
                                    <li><a href="#">Terms and conditions</a></li>
                                    <li><a href="#">Privacy Policy</a></li>
                                </ul><!-- End .widget-list -->
                            </div><!-- End .widget -->
                        </div><!-- End .col-sm-6 col-lg-3 -->

                        <div class="col-sm-6 col-lg-3">
                            <div class="widget">
                                <h4 class="widget-title">My Account</h4><!-- End .widget-title -->

                                <ul class="widget-list">
                                    <li><a href="#">Sign In</a></li>
                                    <li><a href="cart.html">View Cart</a></li>
                                    <li><a href="#">My Wishlist</a></li>
                                    <li><a href="#">Track My Order</a></li>
                                    <li><a href="#">Help</a></li>
                                </ul><!-- End .widget-list -->
                            </div><!-- End .widget -->
                        </div><!-- End .col-sm-6 col-lg-3 -->
                    </div><!-- End .row -->
                </div><!-- End .container -->
            </div><!-- End .footer-middle -->

            <div class="footer-bottom">
                <div class="container">
                    <p class="footer-copyright">Copyright © 2019 Molla Store. All Rights Reserved.</p>
                    <!-- End .footer-copyright -->
                    <figure class="footer-payments">
                        <img src="assets/images/payments.png" alt="Payment methods" width="272" height="20">
                    </figure><!-- End .footer-payments -->
                </div><!-- End .container -->
            </div><!-- End .footer-bottom -->
        </footer><!-- End .footer -->
    </div><!-- End .page-wrapper -->
    <button id="scroll-top" title="Back to Top"><i class="icon-arrow-up"></i></button>

    <!-- Mobile Menu -->
    <div class="mobile-menu-overlay"></div><!-- End .mobil-menu-overlay -->

    <div class="mobile-menu-container">
        <div class="mobile-menu-wrapper">
            <span class="mobile-menu-close"><i class="icon-close"></i></span>

            <form action="#" method="get" class="mobile-search">
                <label for="mobile-search" class="sr-only">Search</label>
                <input type="search" class="form-control" name="mobile-search" id="mobile-search"
                    placeholder="Search in..." required>
                <button class="btn btn-primary" type="submit"><i class="icon-search"></i></button>
            </form>

            <nav class="mobile-nav">
                <ul class="mobile-menu">
                    <li class="active">
                        <a href="index.html">Home</a>

                        <ul>
                            <li><a href="index-1.html">01 - furniture store</a></li>
                            <li><a href="index-2.html">02 - furniture store</a></li>
                            <li><a href="index-3.html">03 - electronic store</a></li>
                            <li><a href="index-4.html">04 - electronic store</a></li>
                            <li><a href="index-5.html">05 - fashion store</a></li>
                            <li><a href="index-6.html">06 - fashion store</a></li>
                            <li><a href="index-7.html">07 - fashion store</a></li>
                            <li><a href="index-8.html">08 - fashion store</a></li>
                            <li><a href="index-9.html">09 - fashion store</a></li>
                            <li><a href="index-10.html">10 - shoes store</a></li>
                            <li><a href="index-11.html">11 - furniture simple store</a></li>
                            <li><a href="index-12.html">12 - fashion simple store</a></li>
                            <li><a href="index-13.html">13 - market</a></li>
                            <li><a href="index-14.html">14 - market fullwidth</a></li>
                            <li><a href="index-15.html">15 - lookbook 1</a></li>
                            <li><a href="index-16.html">16 - lookbook 2</a></li>
                            <li><a href="index-17.html">17 - fashion store</a></li>
                            <li><a href="index-18.html">18 - fashion store (with sidebar)</a></li>
                            <li><a href="index-19.html">19 - games store</a></li>
                            <li><a href="index-20.html">20 - book store</a></li>
                            <li><a href="index-21.html">21 - sport store</a></li>
                            <li><a href="index-22.html">22 - tools store</a></li>
                            <li><a href="index-23.html">23 - fashion left navigation store</a></li>
                            <li><a href="index-24.html">24 - extreme sport store</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="category.html">Shop</a>
                        <ul>
                            <li><a href="category-list.html">Shop List</a></li>
                            <li><a href="category-2cols.html">Shop Grid 2 Columns</a></li>
                            <li><a href="category.html">Shop Grid 3 Columns</a></li>
                            <li><a href="category-4cols.html">Shop Grid 4 Columns</a></li>
                            <li><a href="category-boxed.html"><span>Shop Boxed No Sidebar<span
                                            class="tip tip-hot">Hot</span></span></a></li>
                            <li><a href="category-fullwidth.html">Shop Fullwidth No Sidebar</a></li>
                            <li><a href="product-category-boxed.html">Product Category Boxed</a></li>
                            <li><a href="product-category-fullwidth.html"><span>Product Category Fullwidth<span
                                            class="tip tip-new">New</span></span></a></li>
                            <li><a href="cart.html">Cart</a></li>
                            <li><a href="checkout.html">Checkout</a></li>
                            <li><a href="wishlist.html">Wishlist</a></li>
                            <li><a href="#">Lookbook</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="product.html" class="sf-with-ul">Product</a>
                        <ul>
                            <li><a href="product.html">Default</a></li>
                            <li><a href="product-centered.html">Centered</a></li>
                            <li><a href="product-extended.html"><span>Extended Info<span
                                            class="tip tip-new">New</span></span></a></li>
                            <li><a href="product-gallery.html">Gallery</a></li>
                            <li><a href="product-sticky.html">Sticky Info</a></li>
                            <li><a href="product-sidebar.html">Boxed With Sidebar</a></li>
                            <li><a href="product-fullwidth.html">Full Width</a></li>
                            <li><a href="product-masonry.html">Masonry Sticky Info</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#">Pages</a>
                        <ul>
                            <li>
                                <a href="about.html">About</a>

                                <ul>
                                    <li><a href="about.html">About 01</a></li>
                                    <li><a href="about-2.html">About 02</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="contact.html">Contact</a>

                                <ul>
                                    <li><a href="contact.html">Contact 01</a></li>
                                    <li><a href="contact-2.html">Contact 02</a></li>
                                </ul>
                            </li>
                            <li><a href="login.html">Login</a></li>
                            <li><a href="faq.html">FAQs</a></li>
                            <li><a href="404.html">Error 404</a></li>
                            <li><a href="coming-soon.html">Coming Soon</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="blog.html">Blog</a>

                        <ul>
                            <li><a href="blog.html">Classic</a></li>
                            <li><a href="blog-listing.html">Listing</a></li>
                            <li>
                                <a href="#">Grid</a>
                                <ul>
                                    <li><a href="blog-grid-2cols.html">Grid 2 columns</a></li>
                                    <li><a href="blog-grid-3cols.html">Grid 3 columns</a></li>
                                    <li><a href="blog-grid-4cols.html">Grid 4 columns</a></li>
                                    <li><a href="blog-grid-sidebar.html">Grid sidebar</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#">Masonry</a>
                                <ul>
                                    <li><a href="blog-masonry-2cols.html">Masonry 2 columns</a></li>
                                    <li><a href="blog-masonry-3cols.html">Masonry 3 columns</a></li>
                                    <li><a href="blog-masonry-4cols.html">Masonry 4 columns</a></li>
                                    <li><a href="blog-masonry-sidebar.html">Masonry sidebar</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#">Mask</a>
                                <ul>
                                    <li><a href="blog-mask-grid.html">Blog mask grid</a></li>
                                    <li><a href="blog-mask-masonry.html">Blog mask masonry</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#">Single Post</a>
                                <ul>
                                    <li><a href="single.html">Default with sidebar</a></li>
                                    <li><a href="single-fullwidth.html">Fullwidth no sidebar</a></li>
                                    <li><a href="single-fullwidth-sidebar.html">Fullwidth with sidebar</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="elements-list.html">Elements</a>
                        <ul>
                            <li><a href="elements-products.html">Products</a></li>
                            <li><a href="elements-typography.html">Typography</a></li>
                            <li><a href="elements-titles.html">Titles</a></li>
                            <li><a href="elements-banners.html">Banners</a></li>
                            <li><a href="elements-product-category.html">Product Category</a></li>
                            <li><a href="elements-video-banners.html">Video Banners</a></li>
                            <li><a href="elements-buttons.html">Buttons</a></li>
                            <li><a href="elements-accordions.html">Accordions</a></li>
                            <li><a href="elements-tabs.html">Tabs</a></li>
                            <li><a href="elements-testimonials.html">Testimonials</a></li>
                            <li><a href="elements-blog-posts.html">Blog Posts</a></li>
                            <li><a href="elements-portfolio.html">Portfolio</a></li>
                            <li><a href="elements-cta.html">Call to Action</a></li>
                            <li><a href="elements-icon-boxes.html">Icon Boxes</a></li>
                        </ul>
                    </li>
                </ul>
            </nav><!-- End .mobile-nav -->

            <div class="social-icons">
                <a href="#" class="social-icon" target="_blank" title="Facebook"><i class="icon-facebook-f"></i></a>
                <a href="#" class="social-icon" target="_blank" title="Twitter"><i class="icon-twitter"></i></a>
                <a href="#" class="social-icon" target="_blank" title="Instagram"><i class="icon-instagram"></i></a>
                <a href="#" class="social-icon" target="_blank" title="Youtube"><i class="icon-youtube"></i></a>
            </div><!-- End .social-icons -->
        </div><!-- End .mobile-menu-wrapper -->
    </div><!-- End .mobile-menu-container -->



    <!-- order Details modal -->
    <!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> -->


    <!-- <script>
        $(document).ready(function () {
            let currentOrderId, currentItemId;

            $(document).on('click', '.view-order-btn', function () {
                const orderId = $(this).data('order-id');
                const modalBody = $('#orderModal .modal-body');

                modalBody.empty();
                modalBody.html('<div class="text-center"><i class="fas fa-spinner fa-spin"></i> Loading...</div>');

                $.ajax({
                    url: `/user/order-details/${orderId}`,
                    method: 'GET',
                    success: function (order) {
                        const content = `
                            <div class="row mb-4">
                                <div class="col-md-6 mb-3">
                                    <div class="card order-card">
                                        <div class="card-body">
                                            <h5 class="card-title"><i class="icon-map-marker"></i> Shipping Address</h5>
                                            <p class="card-text">
                                                <strong>${order.address.addressName}</strong><br>
                                                ${order.address.addressStreet}<br>
                                                ${order.address.addressHouse}<br>
                                                ${order.address.addressCity}, ${order.address.addressState} ${order.address.addressPin}<br>
                                                <strong>Phone:</strong> ${order.address.addressMobile}<br>
                                                <strong>Email:</strong> ${order.address.addressEmail}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="card order-card">
                                        <div class="card-body">
                                            <h5 class="card-title"><i class="icon-info-circle"></i> Order Summary</h5>
                                            <p class="card-text">
                                                <strong>Order ID:</strong> ${order.orderId}<br>
                                                <strong>Order Date:</strong> ${new Date(order.createdAt).toLocaleDateString()}<br>
                                                <strong>Payment Method:</strong> ${order.paymentMethod}<br>
                                                <strong>Total Amount:</strong> ₹${order.totalPrice.toFixed(2)}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card mb-4 invoice-card">
                                <div class="card-body">
                                    <h5 class="card-title"><i class="icon-file-text"></i> Invoice</h5>
                                    <div class="table-responsive">
                                        <table class="table table-invoice">
                                            <thead>
                                                <tr>
                                                    <th>Product</th>
                                                    <th class="text-center">Quantity</th>
                                                    <th class="text-right">Price</th>
                                                    <th class="text-right">Subtotal</th>
                                                    <th class="text-center">Status</th>
                                                    <th class="text-center">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                ${order.items.map(item => `
                                                    <tr data-item-id="${item._id}">
                                                        <td>${item.product.productTitle}</td>
                                                        <td class="text-center">${item.quantity}</td>
                                                        <td class="text-right">₹${item.price.toFixed(2)}</td>
                                                        <td class="text-right">₹${(item.price * item.quantity).toFixed(2)}</td>
                                                        <td class="text-center">
                                                            <span class="badge badge-primary">${item.order_status}</span>
                                                        </td>
                                                        <td class="text-center">
                                                            ${item.order_status !== 'Cancelled' && item.order_status !== 'Delivered' && item.order_status !== 'Cancellation Requested' ?
                                `<button type="button" class="btn btn-danger btn-sm cancel-item-btn"
                                                                    data-order-id="${order._id}" data-item-id="${item._id}">
                                                                    Cancel
                                                                </button>`
                                : ''
                            }
                                                        </td>
                                                    </tr>
                                                `).join('')}
                                            </tbody>
                                            <tfoot>
                                                <tr>
                                                    <td colspan="3" class="text-right"><strong>Subtotal:</strong></td>
                                                    <td class="text-right">₹${order.totalPrice.toFixed(2)}</td>
                                                    <td colspan="2"></td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3" class="text-right"><strong>Shipping:</strong></td>
                                                    <td class="text-right">Free</td>
                                                    <td colspan="2"></td>
                                                </tr>
                                                <tr class="total-row">
                                                    <td colspan="3" class="text-right"><strong>Total:</strong></td>
                                                    <td class="text-right"><strong>₹${order.totalPrice.toFixed(2)}</strong></td>
                                                    <td colspan="2"></td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        `;

                        modalBody.html(content);
                        $('#orderModal').modal('show');
                    },
                    error: function () {
                        modalBody.html('<div class="alert alert-danger">Error loading order details.</div>');
                    }
                });
            });

            $(document).on('click', '.cancel-item-btn', function () {
                currentItemId = $(this).data('item-id');
                currentOrderId = $(this).data('order-id');
                $('#cancelItemModal').modal('show');
            });

            $('#confirmCancelItem').on('click', function () {
                const reason = $('#cancelReason').val().trim();
                if (reason === '') {
                    alert('Please provide a reason for cancellation.');
                    return;
                }

                $.ajax({
                    url: `/user/cancel-item/${currentOrderId}/${currentItemId}`,
                    method: 'POST',
                    data: { cancelReason: reason },
                    success: function (response) {
                        $('#cancelItemModal').modal('hide');
                        updateItemStatus(currentItemId, 'Cancellation Requested');
                        alert(response.message);
                    },
                    error: function () {
                        alert('Error cancelling item. Please try again.');
                    }
                });
            });

            function updateItemStatus(itemId, newStatus) {
                $(`#orderModal .modal-body tr[data-item-id="${itemId}"] .badge`)
                    .text(newStatus)
                    .removeClass('badge-primary')
                    .addClass('badge-warning');

                $(`#orderModal .modal-body tr[data-item-id="${itemId}"] .cancel-item-btn`)
                    .prop('disabled', true)
                    .text('Cancellation Requested');
            }
            $('#cancelItemModal').on('hidden.bs.modal', function () {
                $('#cancelReason').val('');
            });
        });
    </script> -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            let currentOrderId, currentItemId;
    
            $(document).on('click', '.view-order-btn', function () {
                const orderId = $(this).data('order-id');
                const modalBody = $('#orderModal .modal-body');
    
                modalBody.empty();
                modalBody.html('<div class="text-center"><i class="fas fa-spinner fa-spin"></i> Loading...</div>');
    
                $.ajax({
                    url: `/user/order-details/${orderId}`,
                    method: 'GET',
                    success: function (order) {
                        const content = `
                            <div class="row mb-4">
                                <div class="col-md-6 mb-3">
                                    <div class="card order-card">
                                        <div class="card-body">
                                            <h5 class="card-title"><i class="icon-map-marker"></i> Shipping Address</h5>
                                            <p class="card-text">
                                                <strong>${order.address.addressName}</strong><br>
                                                ${order.address.addressStreet}<br>
                                                ${order.address.addressHouse}<br>
                                                ${order.address.addressCity}, ${order.address.addressState} ${order.address.addressPin}<br>
                                                <strong>Phone:</strong> ${order.address.addressMobile}<br>
                                                <strong>Email:</strong> ${order.address.addressEmail}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <div class="card order-card">
                                        <div class="card-body">
                                            <h5 class="card-title"><i class="icon-info-circle"></i> Order Summary</h5>
                                            <p class="card-text">
                                                <strong>Order ID:</strong> ${order.orderId}<br>
                                                <strong>Order Date:</strong> ${new Date(order.createdAt).toLocaleDateString()}<br>
                                                <strong>Payment Method:</strong> ${order.paymentMethod}<br>
                                                <strong>Total Amount:</strong> ₹${order.totalPrice.toFixed(2)}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card mb-4 invoice-card">
                                <div class="card-body">
                                    <h5 class="card-title"><i class="icon-file-text"></i> Invoice</h5>
                                    <div class="table-responsive">
                                        <table class="table table-invoice">
                                            <thead>
                                                <tr>
                                                    <th>Product</th>
                                                    <th class="text-center">Quantity</th>
                                                    <th class="text-right">Price</th>
                                                    <th class="text-right">Subtotal</th>
                                                    <th class="text-center">Status</th>
                                                    <th class="text-center">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                ${order.items.map(item => `
                                                    <tr data-item-id="${item._id}">
                                                        <td>${item.product.productTitle}</td>
                                                        <td class="text-center">${item.quantity}</td>
                                                        <td class="text-right">₹${item.price.toFixed(2)}</td>
                                                        <td class="text-right">₹${(item.price * item.quantity).toFixed(2)}</td>
                                                        <td class="text-center">
                                                            <span class="badge badge-primary">${item.order_status}</span>
                                                        </td>
                                                        <td class="text-center">
                                                            ${item.order_status !== 'Cancelled' && item.order_status !== 'Delivered' && item.order_status !== 'Cancellation Requested' ?
                                                                `<button type="button" class="btn btn-danger btn-sm cancel-item-btn"
                                                                    data-order-id="${order._id}" data-item-id="${item._id}">
                                                                    Cancel
                                                                </button>`
                                                            : ''}
                                                            ${item.order_status === 'Delivered' ?
                                                                `<button type="button" class="btn btn-warning btn-sm return-item-btn"
                                                                    data-order-id="${order._id}" data-item-id="${item._id}">
                                                                    Return
                                                                </button>`
                                                            : ''}
                                                        </td>
                                                    </tr>
                                                `).join('')}
                                            </tbody>
                                            <tfoot>
                                                <tr>
                                                    <td colspan="3" class="text-right"><strong>Subtotal:</strong></td>
                                                    <td class="text-right">₹${order.totalPrice.toFixed(2)}</td>
                                                    <td colspan="2"></td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3" class="text-right"><strong>Shipping:</strong></td>
                                                    <td class="text-right">Free</td>
                                                    <td colspan="2"></td>
                                                </tr>
                                                <tr class="total-row">
                                                    <td colspan="3" class="text-right"><strong>Total:</strong></td>
                                                    <td class="text-right"><strong>₹${order.totalPrice.toFixed(2)}</strong></td>
                                                    <td colspan="2"></td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        `;
    
                        modalBody.html(content);
                        $('#orderModal').modal('show');
                    },
                    error: function () {
                        modalBody.html('<div class="alert alert-danger">Error loading order details.</div>');
                    }
                });
            });
    
            $(document).on('click', '.cancel-item-btn', function () {
                currentItemId = $(this).data('item-id');
                currentOrderId = $(this).data('order-id');
                $('#cancelItemModal').modal('show');
            });
    
            $(document).on('click', '.return-item-btn', function () {
                currentItemId = $(this).data('item-id');
                currentOrderId = $(this).data('order-id');
                $('#returnItemModal').modal('show');
            });
    
            $('#confirmCancelItem').on('click', function () {
                const reason = $('#cancelReason').val().trim();
                if (reason === '') {
                    alert('Please provide a reason for cancellation.');
                    return;
                }
    
                $.ajax({
                    url: `/user/cancel-item/${currentOrderId}/${currentItemId}`,
                    method: 'POST',
                    data: { cancelReason: reason },
                    success: function (response) {
                        $('#cancelItemModal').modal('hide');
                        updateItemStatus(currentItemId, 'Cancellation Requested');
                        alert(response.message);
                    },
                    error: function () {
                        alert('Error cancelling item. Please try again.');
                    }
                });
            });
    
            $('#confirmReturnItem').on('click', function () {
                const reason = $('#returnReason').val().trim();
                if (reason === '') {
                    alert('Please provide a reason for return.');
                    return;
                }
    
                $.ajax({
                    url: `/user/return-item/${currentOrderId}/${currentItemId}`,
                    method: 'POST',
                    data: { returnReason: reason },
                    success: function (response) {
                        $('#returnItemModal').modal('hide');
                        updateItemStatus(currentItemId, 'Return Requested');
                        alert(response.message);
                    },
                    error: function () {
                        alert('Error requesting return. Please try again.');
                    }
                });
            });
    
            function updateItemStatus(itemId, newStatus) {
                $(`#orderModal .modal-body tr[data-item-id="${itemId}"] .badge`)
                    .text(newStatus)
                    .removeClass('badge-primary')
                    .addClass(newStatus === 'Cancellation Requested' ? 'badge-warning' : 'badge-info');
    
                $(`#orderModal .modal-body tr[data-item-id="${itemId}"] .cancel-item-btn, #orderModal .modal-body tr[data-item-id="${itemId}"] .return-item-btn`)
                    .prop('disabled', true)
                    .text(newStatus);
            }
    
            $('#cancelItemModal, #returnItemModal').on('hidden.bs.modal', function () {
                $(this).find('textarea').val('');
            });
        });
    </script>


    <!-- Plugins JS File -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/jquery.hoverIntent.min.js"></script>
    <script src="assets/js/jquery.waypoints.min.js"></script>
    <script src="assets/js/superfish.min.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <!-- Main JS File -->
    <script src="assets/js/main.js"></script>


    <%- include ('../layouts/footer.ejs') %>